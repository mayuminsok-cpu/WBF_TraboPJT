<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>API Debug Test</title>
</head>

<body>
    <h1>API接続テスト</h1>
    <button onclick="testAPI()">APIテスト実行</button>
    <pre id="output"></pre>

    <script>
        const API_ENDPOINT = 'https://4z7dznccp7.execute-api.ap-northeast-1.amazonaws.com';
        const USER_ID = 'webapp_user';

        async function testAPI() {
            const output = document.getElementById('output');
            output.textContent = 'テスト中...\n';

            try {
                // Test 1: 最新1件取得
                output.textContent += '\n=== Test 1: 最新1件取得 ===\n';
                const url1 = `${API_ENDPOINT}/data?userId=${USER_ID}`;
                output.textContent += `URL: ${url1}\n`;

                const response1 = await fetch(url1);
                output.textContent += `Status: ${response1.status}\n`;

                const data1 = await response1.json();
                output.textContent += `Response:\n${JSON.stringify(data1, null, 2)}\n`;

                // Test 2: 最新2件取得
                output.textContent += '\n=== Test 2: 最新2件取得 ===\n';
                const url2 = `${API_ENDPOINT}/data?userId=${USER_ID}&limit=2`;
                output.textContent += `URL: ${url2}\n`;

                const response2 = await fetch(url2);
                output.textContent += `Status: ${response2.status}\n`;

                const data2 = await response2.json();
                output.textContent += `Response:\n${JSON.stringify(data2, null, 2)}\n`;

            } catch (error) {
                output.textContent += `\nエラー: ${error.message}\n`;
                output.textContent += `Stack: ${error.stack}\n`;
            }
        }
    </script>
</body>

</html>